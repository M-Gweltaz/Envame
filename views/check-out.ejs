<!-- Header -->
<%- include('layouts/header'); -%>
  <!-- Stripe library -->
  <script src="https://polyfill.io/v3/polyfill.min.js?version=3.52.1&features=fetch"></script>
  <script src="https://js.stripe.com/v3/"></script>
  <title>Envame - SPA 2.0 : panier</title>
</head>

<!-- Navbar -->
<%- include('layouts/navbar'); -%>

<!-- Preview Page -->


<h2 style="height: 35vh;">Mon panier</h2>

<section>
  <div class="product">
    <img
      src="./assets/pictures/spa2.jpeg"
      alt="Envame beauty mask SPA2.0"
    />
    <div class="description">
      <h3>Envame SPA2.0</h3>
      <h5>179â‚¬</h5>
    </div>
  </div>
  <button id="checkout-button">Passer la commande</button>
</section>
<h2 style="height: 5vh;"></h2>


<!-- Footer -->
<%- include('layouts/footer'); -%>

<!-- stripe init -->
<script type="text/javascript">
  // Create an instance of the Stripe object with your publishable API key
  var stripe = Stripe("pk_test_51HziN4EotuTwD83WNz81qsak2gctiV5Kc8odqJXcSB8Db3R2319OW6StdrWOrSSAI8TvkR00BIsyp1Rfbd0nxw5D00ZEzVPjUe");
  var checkoutButton = document.getElementById("checkout-button");
  checkoutButton.addEventListener("click", function () {
    fetch("/check-out/create-checkout-session", {
      method: "POST",
    })
      .then(function (response) {
        return response.json();
      })
      .then(function (session) {
        return stripe.redirectToCheckout({ sessionId: session.id });
      })
      .then(function (result) {
        // If redirectToCheckout fails due to a browser or network
        // error, you should display the localized error message to your
        // customer using error.message.
        if (result.error) {
          alert(result.error.message);
        }
      })
      .catch(function (error) {
        console.error("Error:", error);
      });
  });
</script>
</body>